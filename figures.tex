\documentclass[12pt]{article}


\usepackage[margin=1in]{geometry}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{graphicx}      % include this line if your document contains figures
\usepackage{enumerate}
\usepackage{cite}
\usepackage{circuitikz}
\usetikzlibrary{patterns}
\usetikzlibrary{shapes.geometric}


\definecolor{msblue}{rgb}{0.357, 0.608, 0.835}
\definecolor{msgreen}{rgb}{0.439, 0.678, 0.278}
\definecolor{msred}{rgb}{0.753, 0, 0}
\definecolor{msyellow}{rgb}{0.984, 0.737, 0.0196}



\title{Figures for Unit 3 - PID Control}
\date{\today}
\author{Arne Dankers}


\begin{document}
\maketitle


\begin{figure}[htb]
    \begin{tikzpicture}
        \node[circle,draw,minimum size=1cm] (sum_r) at (-1,0) {};
        \node (m) at ($(sum_r) - (0,0.3)$) {$-$};
        \node (p) at ($(sum_r) - (0.3,0)$) {$+$};
        \node[rectangle,draw,minimum width=2cm,minimum height=1cm] (Kp) at (3,0) {$K_p$};
        \node[rectangle,draw,minimum width=2cm,minimum height=1cm] (Ki) at (3,2) {$\frac{K_i}{s}$};
        \node[rectangle,draw,minimum width=2cm,minimum height=1cm] (Kd) at (3,4) {$K_d s$};

        \node[circle,draw,minimum size=1cm] (sum_k) at (6,0) {$+$};
        \node[circle,draw,minimum size=1cm] (sum_d) at (8,0) {};
        \node (m) at ($(sum_d) + (0,0.3)$) {$+$};
        \node (p) at ($(sum_d) - (0.3,0)$) {$+$};
        \node[rectangle,draw,minimum width=2cm,minimum height=1cm] (P) at (11,0) {$P$};
        \node[circle,draw,minimum size=1cm] (sum_n) at (14,0) {};
        \node (m) at ($(sum_n) + (0,0.3)$) {$+$};
        \node (p) at ($(sum_n) - (0.3,0)$) {$+$};
        \node (r) at (-2,0) {$r$};
        \node (d) at (8,2) {$d$};
        \node (n) at (14,2) {$n$};

        \draw[->] (sum_r) -- node[above, very near start] {$\varepsilon$} (Kp);
        \draw[->] (Kp) -- (sum_k);
        \draw[->] (sum_k) -- node[above] {$u_K$} (sum_d);
        \draw[->] (sum_d) -- node[above] {$u$} (P);
        \draw[->] (P) -- node[above] {$y$} (sum_n);
        \draw[->] (sum_n) -- node[above] {$y_m$} ++(1,0) -- ++(0,-2) -- (-1,-2) -- (sum_r);
        
        \draw[->] (0,0) -- (1,4) -- (Kd);
        \draw[->] (0,0) -- (1,2) -- (Ki);
        \draw[->] (Kd) -- (5,4) -- (sum_k);
        \draw[->] (Ki) -- (5,2) -- (sum_k);
        \draw[->] (r) -- (sum_r);
        \draw[->] (d) -- (sum_d);
        \draw[->] (n) -- (sum_n);

    \end{tikzpicture}
\end{figure}


\end{document}